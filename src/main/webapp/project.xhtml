<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	template="layout/core.xhtml">

	<ui:define name="title">
		<h:outputText value="#{messages.project}" />
	</ui:define>

	<h:panelGrid columns="2" columnClasses="caption,">
		<h:outputText value="#{messages.project_name}" />
		<h:inputText value="#{projectDetail.instance.name}" id="project_name" />

		<h:outputText value="#{messages.project_description}" />
		<h:inputText value="#{projectDetail.instance.description}"
			id="project_description" />

		<h:outputText value="#{messages.project_vcsHost}" />
		<h:selectOneMenu value="#{projectDetail.instance.vcsHost}"
			id="project_vcsHost" converter="vcshostConverter">
			<f:selectItems value="#{projectDetail.vcshostSelectItems}" />
		</h:selectOneMenu>

		<h:outputText value="#{messages.project_vcsPath}" />
		<h:inputText value="#{projectDetail.instance.vcsPath}"
			id="project_vcsPath" disabled="#{projectDetail.managed}" />

		<h:outputText value="#{messages.project_configuredServers}" />
		<h:selectManyMenu value="#{projectDetail.instance.configuredServers}"
			id="project_configuredServers" converter="serverConverter">
			<f:selectItems value="#{projectDetail.allServerSelectItems}" />
			<!-- JSF 2 creates a clone of a completely valid PersistentBag making it lose it's entitymanager, see http://stackoverflow.com/questions/5610908/selectmanycheckbox-lazyinitializationexception-on-process-validation -->
			<f:attribute name="collectionType" value="java.util.ArrayList" />
		</h:selectManyMenu>

		<h:commandButton action="#{projectDetail.chooseWar}"
			rendered="#{empty projectDetail.instance.war}" />
		<h:panelGroup rendered="#{not empty projectDetail.instance.war}">
			<h:outputText value="WAR!" />
			<h:commandButton action="#{projectDetail.chooseMavenArtifact}"
				rendered="#{empty projectDetail.instance.war.mavenArtifact and empty projectDetail.instance.war.spacerUrl}" />
			<h:commandButton action="#{projectDetail.chooseSpacerUrl}"
				rendered="#{empty projectDetail.instance.war.mavenArtifact and empty projectDetail.instance.war.spacerUrl}" />
			<h:panelGrid columns="2" columnClasses="caption,"
				rendered="#{not empty projectDetail.instance.war.mavenArtifact}">
				<h:outputText value="groupId" />
				<h:inputText
					value="#{projectDetail.instance.war.mavenArtifact.groupId}"
					id="groupId" />
				<h:outputText value="artifactId" />
				<h:inputText
					value="#{projectDetail.instance.war.mavenArtifact.artifactId}"
					id="artifactId" />
			</h:panelGrid>
			<h:panelGrid columns="2" columnClasses="caption,"
				rendered="#{not empty projectDetail.instance.war.spacerUrl}">
				<h:outputText value="URL" />
				<h:inputText
					value="#{projectDetail.instance.war.mavenArtifact.spacerUrl}"
					id="spacerUrl" />
				<h:outputText value="Allowed placeholders: [VERSION]" />
			</h:panelGrid>
		</h:panelGroup>

	</h:panelGrid>

	<h:commandButton value="#{messages.save}"
		action="#{projectDetail.save}" />

</ui:composition>